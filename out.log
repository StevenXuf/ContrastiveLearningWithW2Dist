Batch size: train=128, val=1000, test=1000
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [02:22<3:55:37, 142.81s/it]Last batch mean norm: 2.17 0.78 
 variance norm: 16.10 16.07
Learned temperature: 0.0701725738746199
Epoch 1/100, Loss: 15.7632
  2%|▏         | 2/100 [04:40<3:48:23, 139.84s/it]Last batch mean norm: 1.77 0.96 
 variance norm: 16.01 16.08
Learned temperature: 0.07021272478412575
Epoch 2/100, Loss: 4.2975
  3%|▎         | 3/100 [07:01<3:46:32, 140.13s/it]Last batch mean norm: 1.51 0.97 
 variance norm: 15.91 16.05
Learned temperature: 0.07025485622851428
Epoch 3/100, Loss: 3.7494
  4%|▍         | 4/100 [09:19<3:43:26, 139.65s/it]Last batch mean norm: 1.33 1.00 
 variance norm: 15.87 16.06
Learned temperature: 0.07030578149889778
Epoch 4/100, Loss: 3.2368
  5%|▌         | 5/100 [11:38<3:40:23, 139.20s/it]Last batch mean norm: 1.25 1.08 
 variance norm: 15.88 16.05
Learned temperature: 0.07036547736714353
Epoch 5/100, Loss: 2.5869
  6%|▌         | 6/100 [13:56<3:37:24, 138.77s/it]Last batch mean norm: 1.23 1.15 
 variance norm: 15.83 16.06
Learned temperature: 0.07043348685847368
Epoch 6/100, Loss: 1.9569
  7%|▋         | 7/100 [16:16<3:35:46, 139.21s/it]Last batch mean norm: 1.18 1.18 
 variance norm: 15.83 16.05
Learned temperature: 0.07050069413105603
Epoch 7/100, Loss: 1.4659
  8%|▊         | 8/100 [18:34<3:32:40, 138.70s/it]Last batch mean norm: 1.16 1.18 
 variance norm: 15.87 16.08
Learned temperature: 0.07056696598979333
Epoch 8/100, Loss: 1.1892
  9%|▉         | 9/100 [20:54<3:30:59, 139.11s/it]Last batch mean norm: 1.15 1.19 
 variance norm: 15.83 16.10
Learned temperature: 0.07063104551361013
Epoch 9/100, Loss: 0.9748
Last batch mean norm: 1.15 1.23 
 variance norm: 15.84 16.11
Learned temperature: 0.07069727201799147
Epoch 10/100, Loss: 0.8524
 10%|█         | 10/100 [24:25<4:01:57, 161.31s/it]Recall: image-to-text: 0.367000013589859, text-to-image: 0.35100001096725464
Precision: image-to-text: 0.367000013589859, text-to-image: 0.35100001096725464
Top-1 Recall: 0.3590; Precision: 0.3590
 11%|█         | 11/100 [26:44<3:49:15, 154.56s/it]Last batch mean norm: 1.15 1.22 
 variance norm: 15.88 16.12
Learned temperature: 0.07076051410856313
Epoch 11/100, Loss: 0.7360
 12%|█▏        | 12/100 [30:13<4:11:11, 171.27s/it]Last batch mean norm: 1.13 1.21 
 variance norm: 15.86 16.14
Learned temperature: 0.07082625178437472
Epoch 12/100, Loss: 0.6601
 13%|█▎        | 13/100 [33:43<4:25:16, 182.95s/it]Last batch mean norm: 1.13 1.23 
 variance norm: 15.89 16.15
Learned temperature: 0.07089413915973986
Epoch 13/100, Loss: 0.5917
 14%|█▍        | 14/100 [35:58<4:01:29, 168.48s/it]Last batch mean norm: 1.12 1.21 
 variance norm: 15.90 16.18
Learned temperature: 0.0709637416113537
Epoch 14/100, Loss: 0.5276
 15%|█▌        | 15/100 [38:14<3:44:33, 158.51s/it]Last batch mean norm: 1.13 1.26 
 variance norm: 15.89 16.17
Learned temperature: 0.07103417380169089
Epoch 15/100, Loss: 0.4698
 16%|█▌        | 16/100 [40:33<3:33:50, 152.75s/it]Last batch mean norm: 1.15 1.28 
 variance norm: 15.91 16.17
Learned temperature: 0.07110659268681183
Epoch 16/100, Loss: 0.4340
 17%|█▋        | 17/100 [42:52<3:25:35, 148.63s/it]Last batch mean norm: 1.15 1.27 
 variance norm: 15.90 16.19
Learned temperature: 0.07117942996366888
Epoch 17/100, Loss: 0.4008
 18%|█▊        | 18/100 [45:11<3:19:22, 145.88s/it]Last batch mean norm: 1.18 1.29 
 variance norm: 15.96 16.19
Learned temperature: 0.07125746688110088
Epoch 18/100, Loss: 0.3777
 19%|█▉        | 19/100 [47:32<3:14:42, 144.23s/it]Last batch mean norm: 1.11 1.28 
 variance norm: 15.96 16.23
Learned temperature: 0.07133888795190862
Epoch 19/100, Loss: 0.3649
Last batch mean norm: 1.13 1.29 
 variance norm: 15.95 16.23
Learned temperature: 0.07141892407782102
Epoch 20/100, Loss: 0.3395
 20%|██        | 20/100 [51:01<3:38:11, 163.65s/it]Recall: image-to-text: 0.3930000066757202, text-to-image: 0.40300002694129944
Precision: image-to-text: 0.3930000066757202, text-to-image: 0.40300002694129944
Top-1 Recall: 0.3980; Precision: 0.3980
 21%|██        | 21/100 [53:15<3:23:44, 154.74s/it]Last batch mean norm: 1.15 1.29 
 variance norm: 15.92 16.20
Learned temperature: 0.07150274789999342
Epoch 21/100, Loss: 0.3272
 22%|██▏       | 22/100 [55:30<3:13:32, 148.88s/it]Last batch mean norm: 1.14 1.32 
 variance norm: 15.95 16.21
Learned temperature: 0.07159177362608207
Epoch 22/100, Loss: 0.3076
 23%|██▎       | 23/100 [57:50<3:07:50, 146.37s/it]Last batch mean norm: 1.08 1.33 
 variance norm: 15.99 16.24
Learned temperature: 0.07169081313094539
Epoch 23/100, Loss: 0.3033
 24%|██▍       | 24/100 [1:00:10<3:02:46, 144.29s/it]Last batch mean norm: 1.11 1.33 
 variance norm: 16.01 16.22
Learned temperature: 0.07178632297533255
Epoch 24/100, Loss: 0.2867
 25%|██▌       | 25/100 [1:02:31<2:59:16, 143.42s/it]Last batch mean norm: 1.08 1.31 
 variance norm: 16.01 16.24
Learned temperature: 0.07187633258898567
Epoch 25/100, Loss: 0.2637
 26%|██▌       | 26/100 [1:04:46<2:53:50, 140.95s/it]Last batch mean norm: 1.13 1.33 
 variance norm: 16.01 16.24
Learned temperature: 0.07198523850066818
Epoch 26/100, Loss: 0.2722
 27%|██▋       | 27/100 [1:07:07<2:51:28, 140.94s/it]Last batch mean norm: 1.13 1.29 
 variance norm: 16.02 16.28
Learned temperature: 0.07209651721022309
Epoch 27/100, Loss: 0.2656
 28%|██▊       | 28/100 [1:09:29<2:49:20, 141.12s/it]Last batch mean norm: 1.10 1.33 
 variance norm: 16.00 16.26
Learned temperature: 0.07221202917691691
Epoch 28/100, Loss: 0.2569
 29%|██▉       | 29/100 [1:11:44<2:44:43, 139.20s/it]Last batch mean norm: 1.12 1.34 
 variance norm: 15.98 16.26
Learned temperature: 0.07232477394714557
Epoch 29/100, Loss: 0.2425
Last batch mean norm: 1.10 1.34 
 variance norm: 16.02 16.27
Learned temperature: 0.07245727265578497
Epoch 30/100, Loss: 0.2428
 30%|███       | 30/100 [1:15:08<3:05:05, 158.65s/it]Recall: image-to-text: 0.39900001883506775, text-to-image: 0.40400001406669617
Precision: image-to-text: 0.39900001883506775, text-to-image: 0.40400001406669617
Top-1 Recall: 0.4015; Precision: 0.4015
 31%|███       | 31/100 [1:17:29<2:56:18, 153.31s/it]Last batch mean norm: 1.10 1.33 
 variance norm: 15.99 16.29
Learned temperature: 0.07258786579452166
Epoch 31/100, Loss: 0.2347
 32%|███▏      | 32/100 [1:19:43<2:47:23, 147.70s/it]Last batch mean norm: 1.13 1.33 
 variance norm: 16.01 16.29
Learned temperature: 0.07271476519375329
Epoch 32/100, Loss: 0.2167
 33%|███▎      | 33/100 [1:21:58<2:40:36, 143.83s/it]Last batch mean norm: 1.14 1.32 
 variance norm: 16.01 16.28
Learned temperature: 0.07286904418657321
Epoch 33/100, Loss: 0.2193
 34%|███▍      | 34/100 [1:24:13<2:35:15, 141.14s/it]Last batch mean norm: 1.12 1.36 
 variance norm: 16.02 16.27
Learned temperature: 0.07299880467464803
Epoch 34/100, Loss: 0.2056
 35%|███▌      | 35/100 [1:26:34<2:32:57, 141.19s/it]Last batch mean norm: 1.11 1.35 
 variance norm: 16.03 16.27
Learned temperature: 0.07315760501384556
Epoch 35/100, Loss: 0.2037
 36%|███▌      | 36/100 [1:28:55<2:30:26, 141.04s/it]Last batch mean norm: 1.11 1.34 
 variance norm: 16.02 16.27
Learned temperature: 0.07330239313394057
Epoch 36/100, Loss: 0.1902
 37%|███▋      | 37/100 [1:31:15<2:27:42, 140.67s/it]Last batch mean norm: 1.13 1.38 
 variance norm: 16.02 16.27
Learned temperature: 0.07345170681408714
Epoch 37/100, Loss: 0.1858
 38%|███▊      | 38/100 [1:33:34<2:25:04, 140.39s/it]Last batch mean norm: 1.13 1.37 
 variance norm: 16.05 16.30
Learned temperature: 0.07361160739671078
Epoch 38/100, Loss: 0.1776
 39%|███▉      | 39/100 [1:35:49<2:21:05, 138.78s/it]Last batch mean norm: 1.16 1.39 
 variance norm: 16.05 16.29
Learned temperature: 0.07377757795599911
Epoch 39/100, Loss: 0.1735
Last batch mean norm: 1.13 1.35 
 variance norm: 16.05 16.31
Learned temperature: 0.07394368854030647
Epoch 40/100, Loss: 0.1676
 40%|████      | 40/100 [1:39:18<2:39:51, 159.85s/it]Recall: image-to-text: 0.4180000126361847, text-to-image: 0.42500001192092896
Precision: image-to-text: 0.4180000126361847, text-to-image: 0.42500001192092896
Top-1 Recall: 0.4215; Precision: 0.4215
 41%|████      | 41/100 [1:41:32<2:29:30, 152.04s/it]Last batch mean norm: 1.15 1.38 
 variance norm: 16.04 16.28
Learned temperature: 0.07410385009619729
Epoch 41/100, Loss: 0.1574
 42%|████▏     | 42/100 [1:43:47<2:21:53, 146.79s/it]Last batch mean norm: 1.16 1.36 
 variance norm: 16.06 16.29
Learned temperature: 0.0742435057217875
Epoch 42/100, Loss: 0.1478
 43%|████▎     | 43/100 [1:46:01<2:15:48, 142.95s/it]Last batch mean norm: 1.13 1.40 
 variance norm: 16.05 16.29
Learned temperature: 0.07442489553411305
Epoch 43/100, Loss: 0.1537
 44%|████▍     | 44/100 [1:48:21<2:12:33, 142.03s/it]Last batch mean norm: 1.19 1.40 
 variance norm: 16.07 16.28
Learned temperature: 0.07456136421265565
Epoch 44/100, Loss: 0.1399
 45%|████▌     | 45/100 [1:50:41<2:09:36, 141.38s/it]Last batch mean norm: 1.13 1.37 
 variance norm: 16.03 16.30
Learned temperature: 0.07473471810731955
Epoch 45/100, Loss: 0.1321
 46%|████▌     | 46/100 [1:53:01<2:07:01, 141.14s/it]Last batch mean norm: 1.18 1.40 
 variance norm: 16.09 16.28
Learned temperature: 0.07487505840152588
Epoch 46/100, Loss: 0.1237
 47%|████▋     | 47/100 [1:55:16<2:02:57, 139.19s/it]Last batch mean norm: 1.18 1.42 
 variance norm: 16.06 16.28
Learned temperature: 0.0750192220587603
Epoch 47/100, Loss: 0.1250
 48%|████▊     | 48/100 [1:57:36<2:00:53, 139.50s/it]Last batch mean norm: 1.18 1.43 
 variance norm: 16.07 16.27
Learned temperature: 0.0751852463179825
Epoch 48/100, Loss: 0.1188
 49%|████▉     | 49/100 [1:59:57<1:58:56, 139.94s/it]Last batch mean norm: 1.15 1.44 
 variance norm: 16.05 16.28
Learned temperature: 0.07531163361538375
Epoch 49/100, Loss: 0.1077
Last batch mean norm: 1.14 1.41 
 variance norm: 16.06 16.30
Learned temperature: 0.07547051393242334
Epoch 50/100, Loss: 0.1088
 50%|█████     | 50/100 [2:03:22<2:12:59, 159.59s/it]Recall: image-to-text: 0.398000031709671, text-to-image: 0.4280000329017639
Precision: image-to-text: 0.398000031709671, text-to-image: 0.4280000329017639
Top-1 Recall: 0.4130; Precision: 0.4130
 51%|█████     | 51/100 [2:05:43<2:05:39, 153.88s/it]Last batch mean norm: 1.20 1.44 
 variance norm: 16.06 16.30
Learned temperature: 0.07559305609333555
Epoch 51/100, Loss: 0.0981
 52%|█████▏    | 52/100 [2:08:02<1:59:38, 149.55s/it]Last batch mean norm: 1.18 1.44 
 variance norm: 16.07 16.29
Learned temperature: 0.07572598697896299
Epoch 52/100, Loss: 0.0952
 53%|█████▎    | 53/100 [2:10:23<1:55:05, 146.93s/it]Last batch mean norm: 1.18 1.43 
 variance norm: 16.05 16.31
Learned temperature: 0.07587957116857648
Epoch 53/100, Loss: 0.0938
 54%|█████▍    | 54/100 [2:12:44<1:51:15, 145.13s/it]Last batch mean norm: 1.18 1.44 
 variance norm: 16.06 16.31
Learned temperature: 0.07596746813962599
Epoch 54/100, Loss: 0.0852
 55%|█████▌    | 55/100 [2:15:06<1:48:00, 144.02s/it]Last batch mean norm: 1.20 1.46 
 variance norm: 16.07 16.29
Learned temperature: 0.07607179089543611
Epoch 55/100, Loss: 0.0861
 56%|█████▌    | 56/100 [2:17:24<1:44:27, 142.45s/it]Last batch mean norm: 1.24 1.46 
 variance norm: 16.09 16.28
Learned temperature: 0.07616174929369365
Epoch 56/100, Loss: 0.0805
 57%|█████▋    | 57/100 [2:19:43<1:41:22, 141.46s/it]Last batch mean norm: 1.22 1.46 
 variance norm: 16.05 16.28
Learned temperature: 0.07629032808429409
Epoch 57/100, Loss: 0.0780
 58%|█████▊    | 58/100 [2:22:06<1:39:10, 141.67s/it]Last batch mean norm: 1.21 1.47 
 variance norm: 16.08 16.29
Learned temperature: 0.07634919861723674
Epoch 58/100, Loss: 0.0710
 59%|█████▉    | 59/100 [2:24:19<1:35:08, 139.24s/it]Last batch mean norm: 1.17 1.46 
 variance norm: 16.07 16.28
Learned temperature: 0.0764491049541335
Epoch 59/100, Loss: 0.0729
Last batch mean norm: 1.21 1.47 
 variance norm: 16.06 16.27
Learned temperature: 0.07650909731937683
Epoch 60/100, Loss: 0.0677
 60%|██████    | 60/100 [2:27:44<1:45:50, 158.77s/it]Recall: image-to-text: 0.4410000145435333, text-to-image: 0.44300001859664917
Precision: image-to-text: 0.4410000145435333, text-to-image: 0.44300001859664917
Top-1 Recall: 0.4420; Precision: 0.4420
 61%|██████    | 61/100 [2:30:04<1:39:37, 153.28s/it]Last batch mean norm: 1.22 1.49 
 variance norm: 16.06 16.29
Learned temperature: 0.07657900898388882
Epoch 61/100, Loss: 0.0643
 62%|██████▏   | 62/100 [2:32:25<1:34:47, 149.67s/it]Last batch mean norm: 1.19 1.48 
 variance norm: 16.05 16.27
Learned temperature: 0.0766390262367133
Epoch 62/100, Loss: 0.0606
 63%|██████▎   | 63/100 [2:34:46<1:30:39, 147.01s/it]Last batch mean norm: 1.27 1.49 
 variance norm: 16.05 16.28
Learned temperature: 0.07665359276068245
Epoch 63/100, Loss: 0.0562
 64%|██████▍   | 64/100 [2:37:07<1:27:10, 145.30s/it]Last batch mean norm: 1.25 1.49 
 variance norm: 16.05 16.27
Learned temperature: 0.07668907980578774
Epoch 64/100, Loss: 0.0554
 65%|██████▌   | 65/100 [2:39:25<1:23:25, 143.01s/it]Last batch mean norm: 1.27 1.53 
 variance norm: 16.08 16.27
Learned temperature: 0.07672431902681542
Epoch 65/100, Loss: 0.0533
 66%|██████▌   | 66/100 [2:41:40<1:19:37, 140.52s/it]Last batch mean norm: 1.19 1.51 
 variance norm: 16.08 16.27
Learned temperature: 0.0767419114691604
Epoch 66/100, Loss: 0.0499
 67%|██████▋   | 67/100 [2:43:55<1:16:25, 138.97s/it]Last batch mean norm: 1.27 1.51 
 variance norm: 16.08 16.27
Learned temperature: 0.07676683432860647
Epoch 67/100, Loss: 0.0484
 68%|██████▊   | 68/100 [2:46:15<1:14:19, 139.37s/it]Last batch mean norm: 1.22 1.50 
 variance norm: 16.06 16.25
Learned temperature: 0.07681579449758932
Epoch 68/100, Loss: 0.0474
 69%|██████▉   | 69/100 [2:48:32<1:11:30, 138.40s/it]Last batch mean norm: 1.25 1.52 
 variance norm: 16.07 16.24
Learned temperature: 0.07682477111211126
Epoch 69/100, Loss: 0.0438
Last batch mean norm: 1.22 1.52 
 variance norm: 16.09 16.26
Learned temperature: 0.07685210219789877
Epoch 70/100, Loss: 0.0411
 70%|███████   | 70/100 [2:52:02<1:20:00, 160.03s/it]Recall: image-to-text: 0.4650000333786011, text-to-image: 0.46400001645088196
Precision: image-to-text: 0.4650000333786011, text-to-image: 0.46400001645088196
Top-1 Recall: 0.4645; Precision: 0.4645
